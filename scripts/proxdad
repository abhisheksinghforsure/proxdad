#!/bin/bash
#
# proxdad script | MIT License
#
# This script introduce ProxDad version "v1.0" to a user. 
#
#
# It streamlines proxy configuration on Linux. It provides commands for modifying, 
# activating, deactivating, checking status, and locating its installation 
# directory. Users can access usage and version information easily, with options 
# for reporting bugs via GitHub, ensuring efficient system management.
#
#
# Copyright (C) 2024 Abhishek Singh
#

if ! source _utilspxd; then
    exit 1
fi

# Define usage function
usage() {
    echo "Usage: $(basename $0) [-h | --help] [-v | --version] [command]"
    echo -e "\nOptions:"
    echo "  -h, --help      Display this help"
    echo "  -v, --version   Display version information"
    echo -e "\nCommands:"
    echo "  modify          Modify Proxdad settings"
    echo "  off             Turn off Proxdad"
    echo "  on              Turn on Proxdad"
    echo "  status          Get the status of Proxdad"
    echo "  where           Show the location of Proxdad"
    echo -e "\nProxDad $proxdad_version installed at $proxdad_installation_path"
    echo -e "\nProxDad settings specified in $proxdad_config_file"
    echo -e "\nFor bug reports, please visit: \nhttps://github.com/abhisheksinghforsure/proxdad/issues"
    echo -e "\nThis is free software; see the license for copying conditions. There is NO"
    echo "warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE."
    exit 1
}

# Define version function
version() {
    echo "$(basename $0) $proxdad_version"
    exit 0
}

# Parse command-line options
while [[ "$#" -gt 0 ]]; do
    case $1 in
        -h|--help)
            usage
            ;;
        -v|--version)
            version
            ;;
        *)  # If no options match, consider it as a command
            COMMAND="$1"
            ;;
    esac
    shift
done

# Check if command argument is provided
if [ -z "$COMMAND" ]; then
    echo -e "Error: No command specified.\n"
    usage
fi

# Convert shortened command names to full command names
case $COMMAND in
    modify) COMMAND="modifypxd" ;;
    off) COMMAND="offpxd" ;;
    on) COMMAND="onpxd" ;;
    status) COMMAND="statuspxd" ;;
    where) COMMAND="wherepxd" ;;
    *)
        echo -e "Error: Invalid command specified.\n"
        usage
        ;;
esac

# Execute the specified command
"$COMMAND"
